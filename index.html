<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ğŸ‡²ğŸ‡½ Selfies que dan vida</title>
  <style>
    body {
      font-family: "Poppins", sans-serif;
      background: linear-gradient(135deg, #e3f2fd, #bbdefb);
      color: #0d47a1;
      margin: 0;
      padding: 0;
      text-align: center;
    }

    header {
      background-color: #1565c0;
      color: white;
      padding: 20px 10px;
      font-size: 1.6em;
      letter-spacing: 1px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.2);
    }

    .container {
      max-width: 500px;
      margin: 30px auto;
      background: white;
      border-radius: 15px;
      padding: 20px;
      box-shadow: 0 6px 10px rgba(0,0,0,0.15);
    }

    canvas {
      width: 100%;
      border-radius: 12px;
      margin-top: 15px;
      background-color: #f5f5f5;
    }

    .buttons {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      justify-content: center;
      margin-top: 15px;
    }

    button, select, input[type="text"] {
      background-color: #1976d2;
      color: white;
      border: none;
      padding: 10px 15px;
      border-radius: 8px;
      font-size: 1em;
      cursor: pointer;
      transition: 0.3s;
    }

    button:hover, select:hover {
      background-color: #0d47a1;
    }

    input[type="text"] {
      width: 90%;
      color: #0d47a1;
      background: #e3f2fd;
      border: 1px solid #1976d2;
      border-radius: 8px;
    }

    .support-section {
      margin-top: 25px;
      background-color: #e3f2fd;
      border-radius: 10px;
      padding: 15px;
      color: #0d47a1;
      font-weight: 500;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    footer {
      margin-top: 30px;
      font-size: 0.9em;
      color: #1565c0;
    }
  </style>
</head>
<body>

  <header>ğŸ“¸ Selfies que dan vida</header>

  <div class="container">
    <p><strong>Elige o toma una foto, agrega tu frase solidaria y un marco bonito ğŸ’™</strong></p>

    <div class="buttons">
      <button onclick="abrirCamara()">ğŸ“· Tomar foto</button>
      <button onclick="seleccionarImagen()">ğŸ–¼ï¸ Elegir imagen</button>
      <input type="file" id="fileInput" accept="image/*" style="display:none">
    </div>

    <canvas id="canvas"></canvas>

    <input type="text" id="frase" placeholder="Escribe tu frase solidaria aquÃ­ ğŸ’¬">

    <div class="buttons">
      <select id="marcoSelect">
        <option value="">Selecciona un marco</option>
        <option value="marco1">Marco azul</option>
        <option value="marco2">Marco dorado</option>
        <option value="marco3">Marco arcoÃ­ris</option>
      </select>
      <button onclick="aplicarMarco()">ğŸ¨ Aplicar marco</button>
      <button onclick="guardarImagen()">ğŸ’¾ Guardar</button>
      <button onclick="compartirImagen()">ğŸ“¤ Compartir</button>
    </div>

    <div class="support-section">
      <h2>ğŸ’– Apoya la causa</h2>
      <p>Cuenta: 0404040406</p>
      <p>Clave interbancaria: 012180004040404062</p>
      <p>Banco: BBVA Bancomer</p>
      <p>A nombre de: Cruz Roja Mexicana IAP</p>
    </div>
  </div>

  <footer>ğŸ‡²ğŸ‡½ Con amor y solidaridad Â· 2025</footer>

  <script>
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    const fileInput = document.getElementById('fileInput');
    let imagenActual = null;
    let marcoActual = null;

    function seleccionarImagen() {
      fileInput.click();
      fileInput.onchange = e => {
        const archivo = e.target.files[0];
        if (!archivo) return;
        const img = new Image();
        img.onload = () => {
          dibujarImagen(img);
        };
        img.src = URL.createObjectURL(archivo);
      };
    }

    function abrirCamara() {
      const input = document.createElement('input');
      input.type = 'file';
      input.accept = 'image/*';
      input.capture = 'environment';
      input.onchange = e => {
        const archivo = e.target.files[0];
        if (!archivo) return;
        const img = new Image();
        img.onload = () => {
          dibujarImagen(img);
        };
        img.src = URL.createObjectURL(archivo);
      };
      input.click();
    }

    function dibujarImagen(img) {
      canvas.width = 400;
      canvas.height = 400;
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
      imagenActual = img;
      marcoActual = null;
    }

    function aplicarMarco() {
      if (!imagenActual) return alert("Primero elige o toma una foto");
      const marco = document.getElementById('marcoSelect').value;
      const frase = document.getElementById('frase').value;

      ctx.clearRect(0, 0, canvas.width, canvas.height);
      ctx.drawImage(imagenActual, 0, 0, canvas.width, canvas.height);

      // Texto visible
      if (frase.trim() !== "") {
        ctx.font = "bold 20px Poppins";
        ctx.fillStyle = "white";
        ctx.strokeStyle = "black";
        ctx.lineWidth = 3;
        ctx.textAlign = "center";
        ctx.strokeText(frase, canvas.width / 2, canvas.height - 20);
        ctx.fillText(frase, canvas.width / 2, canvas.height - 20);
      }

      // Marcos
      ctx.lineWidth = 20;
      if (marco === "marco1") {
        ctx.strokeStyle = "#1976d2";
      } else if (marco === "marco2") {
        ctx.strokeStyle = "gold";
      } else if (marco === "marco3") {
        const grad = ctx.createLinearGradient(0, 0, canvas.width, 0);
        grad.addColorStop(0, "red");
        grad.addColorStop(0.2, "orange");
        grad.addColorStop(0.4, "yellow");
        grad.addColorStop(0.6, "green");
        grad.addColorStop(0.8, "blue");
        grad.addColorStop(1, "violet");
        ctx.strokeStyle = grad;
      } else {
        return;
      }
      ctx.strokeRect(10, 10, canvas.width - 20, canvas.height - 20);
      marcoActual = marco;
    }

    function guardarImagen() {
      if (!imagenActual) return alert("No hay imagen para guardar");
      const enlace = document.createElement('a');
      enlace.download = 'selfie_solidaria.png';
      enlace.href = canvas.toDataURL();
      enlace.click();
    }

    async function compartirImagen() {
      if (!imagenActual) return alert("No hay imagen para compartir");
      canvas.toBlob(async blob => {
        const archivo = new File([blob], "selfie_solidaria.png", { type: "image/png" });
        if (navigator.canShare && navigator.canShare({ files: [archivo] })) {
          await navigator.share({
            files: [archivo],
            title: "Selfie solidaria ğŸ’™",
            text: "Â¡Mira mi selfie solidaria! ğŸ‡²ğŸ‡½",
          });
        } else {
          alert("Tu dispositivo no admite la funciÃ³n de compartir.");
        }
      });
    }
  </script>
</body>
  </html>
